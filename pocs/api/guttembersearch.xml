<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
  <meta>
    <author>Alberto and Francisco from the O2 Lab UK</author>
    <description>Uses google search to try to find ebooks in the Guttemberg Project</description>
    <documentationURL></documentationURL>
    <sampleQuery>select * from {table} where book="Alice in wonderland"</sampleQuery>
  </meta>
  <bindings>
    <select itemPath="" produces="XML">
      <urls>
        <url />
      </urls>
      <inputs>
        <key id="book" type="xs:string" paramType='variable' required='true'/>
      </inputs>
      <execute><![CDATA[
          y.env('store://datatables.org/alltableswithkeys');
        
          var results = y.query('select * from google.search where q = "' + book + ' site:gutenberg.org inurl:/ebooks/"').results;
        
          var books = <books></books>;
          var book;
          for(var i in results.results) {
            book = <book></book>;
            book.appendChild(<title>{results.results[i].titleNoFormatting.text()}</title>);
            book.appendChild(<url>{results.results[i].url.text()}</url>);
            book.appendChild(<cache>{results.results[i].cacheUrl.text()}</cache>);
            books.appendChild(book);
            //y.log(results.results[i]);
          }
        
          response.object = books;
        
      ]]></execute>
    </select>
  </bindings>
</table>
